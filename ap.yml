---
- name: Configure Cisco AP via Telnet
  hosts: ap
  gather_facts: no

  vars:
    ap_host: 10.62.10.3
    ap_username: admin
    ap_password: pass

  tasks:
    - name: Send commands to Cisco AP via Telnet
      expect:
        command: "telnet {{ ap_host }}"
        responses:
          'Username:': "{{ ap_username }}"
          'Password:': "{{ ap_password }}"
          'AP#': |
            configure terminal
            no Dot11 ssid 62_Rivan
            Dot11 ssid 62_Rivan
            authentication open
            authentication key-management wpa
            wpa-psk ascii C1sc0123
            guest-mode
            interface Dot11Radio 0
            channel 9
            no shut
            encryption mode ciphers tkip
            ssid 62_rivan
            end
            write memory
      register: telnet_output
      
    - name: Show Telnet output
      debug:
        var: telnet_output.stdout
